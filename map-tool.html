<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>네이버 지도 API 테스트</title>
<script type="text/javascript" src="https://oapi.map.naver.com/openapi/v3/maps.js?ncpClientId=q581f6wc1o&ncpClientSecret=0W7Ouyl18C6u2N8B5gJ93MQfj0za0feYNLYOYF6c&submodules=geocoder"></script>
</head>
<body>
<h1>네이버 지도 API 테스트</h1>

<div id="status" style="display:none;"></div>

<input id="address" placeholder="주소 입력">
<button onclick="testGeocode()">테스트</button>

<div id="map" style="height:400px;background:#f0f0f0;">지도 로딩중...</div>

<div id="result" style="display:none;">
  <strong>좌표:</strong>
  <div id="coords"></div>
</div>

<script>
function showStatus(msg, isError = false) {
  const status = document.getElementById('status');
  status.textContent = msg;
  status.style.color = isError ? 'red' : 'green';
  status.style.display = 'block';
}

function testGeocode() {
  const address = document.getElementById('address').value.trim();
  if (!address) return alert('주소를 입력하세요!');
  
  const btn = document.querySelector('button');
  btn.disabled = true;
  btn.textContent = '검색중...';
  showStatus('테스트 중...', false);
  
  naver.maps.Service.geocode({
    query: address
  }, function(status, response) {
    btn.disabled = false;
    btn.textContent = '테스트';
    
    if (status === naver.maps.Service.Status.OK) {
      const result = response.v2.addresses[0];
      const lat = parseFloat(result.y);
      const lng = parseFloat(result.x);
      
      showStatus('✅ API 정상 작동!', false);
      document.getElementById('coords').textContent = `${lat.toFixed(6)}, ${lng.toFixed(6)}`;
      document.getElementById('result').style.display = 'block';
      
      const map = new naver.maps.Map('map', {
        center: new naver.maps.LatLng(lat, lng),
        zoom: 17
      });
      
      new naver.maps.Marker({
        position: new naver.maps.LatLng(lat, lng),
        map: map
      });
      
    } else {
      showStatus(`❌ 실패: ${status}`, true);
    }
  });
}

document.getElementById('address').addEventListener('keypress', e => {
  if (e.key === 'Enter') testGeocode();
});
</script>
</body>
</html>
