<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>ì£¼ì†Œ â†’ ì¢Œí‘œ ë³€í™˜ê¸°</title>
  <script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=5aa11b53a04d1bb6f78c87e27a21a400&libraries=services"></script>
  <style>
    body { font-family: -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Noto Sans KR",sans-serif; padding:20px; max-width:600px; margin:0 auto; }
    #map { width:100%; height:400px; border-radius:12px; margin:20px 0; }
    .address-input { width:100%; padding:12px; border:1px solid #ddd; border-radius:8px; font-size:16px; box-sizing:border-box; }
    .btn { background:#fee500; color:#000; border:none; padding:12px 24px; border-radius:8px; font-size:16px; font-weight:500; cursor:pointer; margin:10px 0; }
    .btn:hover { background:#ffeb3b; }
    .result { background:#f8f9fa; padding:16px; border-radius:8px; margin:10px 0; }
    .coords { font-family:monospace; background:#333; color:#0f0; padding:8px; border-radius:4px; word-break:break-all; }
  </style>
</head>
<body>
  <h2>ğŸ  ì£¼ì†Œ â†’ ì¢Œí‘œ ë³€í™˜</h2>
  
  <input type="text" id="address" class="address-input" placeholder="ì—¬ê¸°ì— ë¹Œë”© ì£¼ì†Œë¥¼ ì…ë ¥í•˜ì„¸ìš” (ì˜ˆ: ì„œìš¸íŠ¹ë³„ì‹œ ê°•ë‚¨êµ¬ í…Œí—¤ë€ë¡œ 123)">
  <br>
  <button class="btn" onclick="geocodeAddress()">ğŸ“ ì¢Œí‘œ ì°¾ê¸° & ë³µì‚¬</button>
  
  <div id="map"></div>
  <div id="result" class="result" style="display:none;">
    <strong>âœ… ì¢Œí‘œê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!</strong><br>
    <div id="coords" class="coords"></div>
    <small>ì´ ê°’ì„ ë…¸ì…˜ Lat, Lng í•„ë“œì— ë¶™ì—¬ë„£ìœ¼ì„¸ìš”</small>
  </div>

  <script>
    let map, marker;

    // URL íŒŒë¼ë¯¸í„°ì—ì„œ ì£¼ì†Œ ìë™ ì…ë ¥
    const urlParams = new URLSearchParams(window.location.search);
    const paramAddress = urlParams.get('address');
    if (paramAddress) {
      document.getElementById('address').value = decodeURIComponent(paramAddress);
    }

    function geocodeAddress() {
      const address = document.getElementById('address').value.trim();
      if (!address) {
        alert('ì£¼ì†Œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”!');
        return;
      }

      // ì¹´ì¹´ì˜¤ ì§€ì˜¤ì½”ë”© API
      const geocoder = new kakao.maps.services.Geocoder();
      geocoder.addressSearch(address, (result, status) => {
        if (status === kakao.maps.services.Status.OK) {
          const coords = result[0].address;
          const lat = coords.y;
          const lng = coords.x;
          
          // ì§€ë„ ìƒì„±
          showMap(lat, lng, result[0].address_name);
          
          // ì¢Œí‘œ ë¬¸ìì—´ ìƒì„± & ë³µì‚¬
          const coordText = `${lat},${lng}`;
          navigator.clipboard.writeText(coordText).then(() => {
            document.getElementById('coords').textContent = coordText;
            document.getElementById('result').style.display = 'block';
            document.getElementById('result').scrollIntoView({ behavior: 'smooth' });
          });
          
        } else {
          alert('ì£¼ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ë„ë¡œëª…ì£¼ì†Œë¥¼ ì •í™•íˆ ì…ë ¥í•´ì£¼ì„¸ìš”.');
        }
      });
    }

    function showMap(lat, lng, addressName) {
      const mapContainer = document.getElementById('map');
      const mapOption = {
        center: new kakao.maps.LatLng(lat, lng),
        level: 3
      };
      map = new kakao.maps.Map(mapContainer, mapOption);
      
      // ë§ˆì»¤ ì¶”ê°€
      marker = new kakao.maps.Marker({
        position: new kakao.maps.LatLng(lat, lng),
        map: map
      });
      
      // ì¸í¬ìœˆë„ìš°
      const infowindow = new kakao.maps.InfoWindow({
        content: `<div style="padding:5px;font-size:12px;">${addressName}</div>`
      });
      infowindow.open(map, marker);
    }

    // Enterí‚¤ë¡œë„ ì‹¤í–‰
    document.getElementById('address').addEventListener('keypress', (e) => {
      if (e.key === 'Enter') geocodeAddress();
    });
  </script>
</body>
</html>
