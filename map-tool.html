<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>ê³µì‹¤ì •ë³´ â†’ ë„¤ì´ë²„ ë§í¬ ë³€í™˜</title>
<style>
body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; }
input { width: 100%; padding: 16px; font-size: 16px; border: 2px solid #ddd; border-radius: 12px; box-sizing: border-box; margin-bottom: 12px; }
button { width: 100%; padding: 16px; font-size: 16px; background: linear-gradient(135deg, #03c75a, #02a84a); color: white; border: none; border-radius: 12px; cursor: pointer; transition: all 0.2s; }
button:hover:not(:disabled) { transform: translateY(-2px); box-shadow: 0 8px 20px rgba(3,199,90,0.3); }
button:disabled { background: #ccc; cursor: not-allowed; }
#result { display: none; padding: 24px; background: linear-gradient(135deg, #f0f8ff 0%, #e3f2fd 100%); border-left: 5px solid #2196f3; border-radius: 12px; margin-top: 20px; }
.link-box { background: rgba(255,255,255,0.8); padding: 20px; border-radius: 12px; margin: 12px 0; backdrop-filter: blur(10px); }
.link-item { margin: 16px 0; }
.link-title { font-weight: bold; font-size: 16px; margin-bottom: 8px; display: flex; align-items: center; }
.link-title::before { content: ''; display: inline-block; width: 24px; height: 24px; margin-right: 8px; }
#realtorLink ~ .link-title::before { background: #ff7043; mask: url('data:image/svg+xml,<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path fill="%23fff" d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/></svg>') no-repeat center; mask-size: contain; }
#mapLink ~ .link-title::before { background: #4285f4; mask: url('data:image/svg+xml,<svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path fill="%23fff" d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/></svg>') no-repeat center; mask-size: contain; }
a { color: #1976d2; font-size: 15px; font-family: monospace; background: rgba(25,118,210,0.1); padding: 8px 12px; border-radius: 6px; text-decoration: none; word-break: break-all; display: block; transition: all 0.2s; }
a:hover { background: rgba(25,118,210,0.2); color: #0d47a1; }
.error { background: #ffebee; border-left-color: #f44336; color: #c62828; }
</style>
</head>
<body>
<h1>ğŸ  ê³µì‹¤ì •ë³´ ì£¼ì†Œ â†’ ë„¤ì´ë²„ ë§í¬ ë³€í™˜ê¸°</h1>
<p>ì„œìš¸ì‹œ ë‚´ ì£¼ì†Œ ì…ë ¥ ì‹œ ë„¤ì´ë²„ ë¶€ë™ì‚°/ì§€ë„ ë§í¬ ìë™ ìƒì„±</p>

<input id="address" placeholder="ì˜ˆ: ì„œìš¸ ê°•ë‚¨êµ¬ ì—­ì‚¼ë™ 123-45 ë˜ëŠ” ì„œìš¸íŠ¹ë³„ì‹œ ê°•ë‚¨êµ¬..." style="width:100%;padding:12px;font-size:16px;border:1px solid #ddd;">

<button onclick="convertToNaverLinks()">ğŸ”— ë„¤ì´ë²„ ë§í¬ ìƒì„±</button>

<div id="result">
  <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 20px;">
    <strong>âœ… ë³€í™˜ ì™„ë£Œ!</strong>
    <button onclick="copyAllLinks()" style="padding: 8px 16px; background: #ff9800; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 14px;">ğŸ“‹ ì „ì²´ ë³µì‚¬</button>
  </div>
  
  <div class="link-box">
    <div class="link-item">
      <div class="link-title">ğŸ“ˆ ë„¤ì´ë²„ ë¶€ë™ì‚°</div>
      <a id="realtorLink" href="#" target="_blank">https://land.naver.com/</a>
    </div>
    
    <div class="link-item">
      <div class="link-title">ğŸ—ºï¸ ë„¤ì´ë²„ ì§€ë„</div>
      <a id="mapLink" href="#" target="_blank">https://map.naver.com/</a>
    </div>
    
    <div class="link-item">
      <div class="link-title">ğŸ¯ ì§ë§í¬ (ì§€ë„)</div>
      <a id="directMapLink" href="#" target="_blank">https://map.naver.com/</a>
    </div>
  </div>
</div>

<script>
// ë„¤ì´ë²„ API ë¡œë“œ (ê³µì‹ í´ë¼ì´ì–¸íŠ¸ ID ì‚¬ìš© - ì‹¤ì œ ì„œë¹„ìŠ¤ì—ì„œëŠ” ë³¸ì¸ í‚¤ ì‚¬ìš© ê¶Œì¥)
let naverReady = false;
function loadNaverAPI() {
  if (naverReady) return Promise.resolve();
  
  return new Promise((resolve, reject) => {
    if (window.naver?.maps) {
      naverReady = true;
      resolve();
      return;
    }
    
    const script = document.createElement('script');
    script.src = 'https://oapi.map.naver.com/openapi/v3/maps.js?ncpClientId=q581f6wc1o';
    script.async = true;
    script.onload = () => {
      naverReady = true;
      resolve();
    };
    script.onerror = () => reject(new Error('Naver API ë¡œë“œ ì‹¤íŒ¨'));
    document.head.appendChild(script);
  });
}

async function convertToNaverLinks() {
  const address = document.getElementById('address').value.trim();
  const btn = document.querySelector('button');
  const result = document.getElementById('result');
  
  if (!address) {
    alert('ğŸ“ ì£¼ì†Œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”!');
    return;
  }
  
  // UI ìƒíƒœ ë³€ê²½
  btn.disabled = true;
  btn.innerHTML = 'â³ ì¢Œí‘œ ë³€í™˜ ì¤‘...';
  result.style.display = 'none';
  
  try {
    // ë„¤ì´ë²„ API ëŒ€ê¸°
    await loadNaverAPI();
    
    // Geocoding ìˆ˜í–‰
    const geocodeResult = await new Promise((resolve, reject) => {
      naver.maps.Service.geocode({
        query: address
      }, (status, response) => {
        if (status === naver.maps.Service.Status.OK && response.v2.addresses?.length > 0) {
          resolve(response.v2.addresses[0]);
        } else {
          reject(new Error(`Geocoding ì‹¤íŒ¨: ${status}`));
        }
      });
    });
    
    const { y: lat, x: lng, roadAddress, jibunAddress } = geocodeResult;
    const fullAddress = roadAddress || jibunAddress || address;
    
    // ë§í¬ ìƒì„± (ìˆ˜ì •ëœ ì •í™•í•œ í˜•ì‹)
    const realtorLink = `https://land.naver.com/complex/web?ms=${lat},${lng}&e=1`;
    const mapLink = `https://map.naver.com/p/search/${encodeURIComponent(fullAddress)}`;
    const directMapLink = `https://map.naver.com/p/crd/1,0,0,0,dh/${encodeURIComponent(fullAddress)}`;
    
    // ê²°ê³¼ í‘œì‹œ
    document.getElementById('realtorLink').href = realtorLink;
    document.getElementById('realtorLink').textContent = realtorLink;
    document.getElementById('mapLink').href = mapLink;
    document.getElementById('mapLink').textContent = mapLink;
    document.getElementById('directMapLink').href = directMapLink;
    document.getElementById('directMapLink').textContent = directMapLink;
    
    result.className = '';
    result.style.display = 'block';
    result.scrollIntoView({ behavior: 'smooth' });
    
  } catch (error) {
    console.error('ë³€í™˜ ì˜¤ë¥˜:', error);
    
    // ëŒ€ì²´ ë°©ë²•: ìˆ˜ë™ ì¢Œí‘œ ì¶”ì • (ì„œìš¸ ê¸°ì¤€)
    const fallbackLinks = generateFallbackLinks(address);
    
    document.getElementById('realtorLink').href = fallbackLinks.realtor;
    document.getElementById('realtorLink').textContent = fallbackLinks.realtor;
    document.getElementById('mapLink').href = fallbackLinks.map;
    document.getElementById('mapLink').textContent = fallbackLinks.map;
    
    result.className = 'error';
    result.innerHTML = `
      <div style="display: flex; align-items: center; gap: 12px;">
        <strong>âš ï¸ API ì œí•œìœ¼ë¡œ ëŒ€ì²´ ë§í¬ ìƒì„±</strong>
        <button onclick="copyAllLinks()" style="padding: 8px 16px; background: #ff9800; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 14px;">ğŸ“‹ ì „ì²´ ë³µì‚¬</button>
      </div>
      ${result.querySelector('.link-box').outerHTML}
    `;
    result.style.display = 'block';
    result.scrollIntoView({ behavior: 'smooth' });
  } finally {
    btn.disabled = false;
    btn.innerHTML = 'ğŸ”— ë„¤ì´ë²„ ë§í¬ ìƒì„±';
  }
}

function generateFallbackLinks(address) {
  const encodedAddress = encodeURIComponent(address);
  return {
    realtor: `https://land.naver.com/search?query=${encodedAddress}`,
    map: `https://map.naver.com/p/search/${encodedAddress}`
  };
}

function copyAllLinks() {
  const links = [
    document.getElementById('realtorLink').href,
    document.getElementById('mapLink').href,
    document.getElementById('directMapLink')?.href || ''
  ].filter(Boolean).join('\n');
  
  navigator.clipboard.writeText(links).then(() => {
    const btn = event.target;
    const original = btn.textContent;
    btn.textContent = 'âœ… ë³µì‚¬ë¨!';
    btn.style.background = '#4caf50';
    setTimeout(() => {
      btn.textContent = original;
      btn.style.background = '';
    }, 2000);
  }).catch(() => {
    // Fallback for older browsers
    const textarea = document.createElement('textarea');
    textarea.value = links;
    document.body.appendChild(textarea);
    textarea.select();
    document.execCommand('copy');
    document.body.removeChild(textarea);
  });
}

// Enter í‚¤ ì§€ì›
document.getElementById('address').addEventListener('keypress', e => {
  if (e.key === 'Enter') convertToNaverLinks();
});

// URL íŒŒë¼ë¯¸í„° ìë™ ì‹¤í–‰ (ì˜¤íƒ€ ìˆ˜ì •: address â†’ addr)
const urlParams = new URLSearchParams(location.search);
const addr = urlParams.get('addr') || urlParams.get('address');
if (addr) {
  document.getElementById('address').value = decodeURIComponent(addr);
  setTimeout(convertToNaverLinks, 1000);
}
</script>
</body>
</html>
