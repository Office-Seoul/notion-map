<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ğŸ  ê³µì‹¤ì •ë³´ â†’ ë„¤ì´ë²„ ë§í¬ ë³€í™˜ (í™•ì¥í”„ë¡œê·¸ë¨ ë²„ì „)</title>
<style>
* { margin: 0; padding: 0; box-sizing: border-box; }
body { 
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Noto Sans KR, sans-serif; 
  max-width: 800px; margin: 0 auto; padding: 20px; line-height: 1.6;
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  min-height: 100vh;
}
.container { background: rgba(255,255,255,0.95); border-radius: 20px; padding: 30px; box-shadow: 0 20px 40px rgba(0,0,0,0.1); }
h1 { text-align: center; color: #333; margin-bottom: 10px; font-size: 1.8em; }
.subtitle { text-align: center; color: #666; margin-bottom: 30px; }

.input-group { margin-bottom: 20px; }
input { 
  width: 100%; padding: 18px; font-size: 16px; border: 2px solid #e1e5e9; border-radius: 12px; 
  transition: all 0.3s; background: #fff;
}
input:focus { outline: none; border-color: #03c75a; box-shadow: 0 0 0 3px rgba(3,199,90,0.1); }

.btn { 
  width: 100%; padding: 18px; font-size: 16px; font-weight: 600; 
  background: linear-gradient(135deg, #03c75a, #02a84a); 
  color: white; border: none; border-radius: 12px; cursor: pointer; 
  transition: all 0.3s; position: relative; overflow: hidden; margin: 5px 0;
}
.btn:hover:not(:disabled) { transform: translateY(-2px); box-shadow: 0 10px 25px rgba(3,199,90,0.4); }
.btn:disabled { background: #ccc; cursor: not-allowed; transform: none; }
.btn-secondary { background: linear-gradient(135deg, #2196f3, #1976d2); }
.btn-copy { background: linear-gradient(135deg, #ff9800, #f57c00); padding: 10px 20px; width: auto; margin-left: 10px; }
.btn.loading::after { content: ''; position: absolute; top: 50%; left: 50%; width: 0; height: 0; background: rgba(255,255,255,0.3); border-radius: 50%; transform: translate(-50%,-50%); animation: spin 1s linear infinite; }
@keyframes spin { to { transform: translate(-50%,-50%) rotate(360deg); } }

#result { 
  display: none; margin-top: 30px; padding: 25px; 
  background: linear-gradient(135deg, #f0f8ff 0%, #e3f2fd 100%); 
  border-radius: 16px; border-left: 5px solid #2196f3;
}
.result-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; flex-wrap: wrap; gap: 10px; }
.link-group { background: rgba(255,255,255,0.8); padding: 20px; border-radius: 12px; margin: 15px 0; }
.link-item { margin: 20px 0; }
.link-label { font-weight: 600; font-size: 15px; margin-bottom: 8px; display: flex; align-items: center; gap: 8px; }
.link-url { 
  display: block; color: #1976d2; font-family: 'Courier New', monospace; font-size: 14px; 
  background: rgba(25,118,210,0.08); padding: 12px; border-radius: 8px; 
  word-break: break-all; text-decoration: none; transition: all 0.2s;
}
.link-url:hover { background: rgba(25,118,210,0.15); color: #0d47a1; transform: translateX(5px); }

.property-types, .deal-types { display: flex; flex-wrap: wrap; gap: 8px; margin: 15px 0; }
.toggle-btn { 
  padding: 8px 12px; border: 2px solid #ddd; background: white; border-radius: 20px; 
  cursor: pointer; font-size: 13px; transition: all 0.2s; white-space: nowrap;
}
.toggle-btn[data-checked="true"] { background: #03c75a; color: white; border-color: #03c75a; }
.toggle-btn:hover { transform: translateY(-1px); box-shadow: 0 4px 8px rgba(0,0,0,0.1); }
.radio-btns .toggle-btn { border-radius: 8px; }

.error { background: linear-gradient(135deg, #ffebee 0%, #ffcdd2 100%); border-left-color: #f44336; }

@media (max-width: 600px) { 
  .container { padding: 20px; margin: 10px; } 
  h1 { font-size: 1.5em; } 
  .result-header { flex-direction: column; }
}
</style>
</head>
<body>
<div class="container">
  <h1>ğŸ  ê³µì‹¤ì •ë³´ â†’ ë„¤ì´ë²„ ë§í¬ ë³€í™˜ê¸°</h1>
  <p class="subtitle">ì£¼ì†Œ ì…ë ¥í•˜ë©´ ë„¤ì´ë²„ ë¶€ë™ì‚° + ì§€ë„ ë§í¬ ìë™ ìƒì„± (í™•ì¥í”„ë¡œê·¸ë¨ ìŠ¤íƒ€ì¼)</p>

  <div class="input-group">
    <input id="address" placeholder="ì˜ˆ: ì„œìš¸ ê°•ë‚¨êµ¬ ì—­ì‚¼ë™ 123-45" />
    <button id="convertBtn" class="btn">ğŸ”— ë„¤ì´ë²„ ë§í¬ ìƒì„±</button>
  </div>

  <!-- ë§¤ë¬¼/ê±°ë˜ ìœ í˜• ì„ íƒ (í™•ì¥í”„ë¡œê·¸ë¨ì²˜ëŸ¼) -->
  <div style="background: rgba(255,255,255,0.7); padding: 20px; border-radius: 12px; margin-bottom: 20px;">
    <div style="font-weight: 600; margin-bottom: 10px;">ğŸ“‹ ë§¤ë¬¼ ìœ í˜• (ë³µìˆ˜ ì„ íƒ)</div>
    <div class="property-types" id="property-types">
      <button class="toggle-btn" data-value="APTHGJ">ì§€ì‹ì‚°ì—…ì„¼í„°</button>
      <button class="toggle-btn" data-value="SG" data-checked="true">ìƒê°€</button>
      <button class="toggle-btn" data-value="SMS" data-checked="true">ì‚¬ë¬´ì‹¤</button>
      <button class="toggle-btn" data-value="TJ">í† ì§€</button>
      <button class="toggle-btn" data-value="GM">ê±´ë¬¼</button>
    </div>
    
    <div style="font-weight: 600; margin: 15px 0 10px 0;">ğŸ’° ê±°ë˜ ìœ í˜• (ë‹¨ì¼ ì„ íƒ)</div>
    <div class="property-types radio-btns" id="deal-types">
      <button class="toggle-btn radio" data-value="A1">ë§¤ë§¤</button>
      <button class="toggle-btn radio" data-value="B1">ì „ì„¸</button>
      <button class="toggle-btn radio" data-value="B2" data-checked="true">ì›”ì„¸</button>
      <button class="toggle-btn radio" data-value="B3">ë‹¨ê¸°ì„ëŒ€</button>
    </div>
  </div>

  <div id="result">
    <div class="result-header">
      <strong>âœ… ë³€í™˜ ì™„ë£Œ!</strong>
      <button id="copyBtn" class="btn-copy">ğŸ“‹ ì „ì²´ ë³µì‚¬</button>
    </div>
    
    <div class="link-group">
      <div class="link-item">
        <div class="link-label">ğŸ—ºï¸ ë„¤ì´ë²„ ì§€ë„</div>
        <a id="mapLink" class="link-url" href="#" target="_blank">https://map.naver.com/</a>
      </div>
      
      <div class="link-item">
        <div class="link-label">ğŸ¢ ë„¤ì´ë²„ ë¶€ë™ì‚°</div>
        <a id="realtorLink" class="link-url" href="#" target="_blank">https://land.naver.com/</a>
      </div>
    </div>
  </div>
</div>

<script>
// === í™•ì¥í”„ë¡œê·¸ë¨ ìŠ¤íƒ€ì¼ ë„¤ì´ë²„ ë§í¬ ìƒì„± ===
async function convertToNaverLinks() {
  const address = document.getElementById('address').value.trim();
  const btn = document.getElementById('convertBtn');
  const result = document.getElementById('result');
  
  if (!address) {
    alert('ğŸ“ ì£¼ì†Œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”!');
    return;
  }
  
  // UI ë¡œë”© ìƒíƒœ
  btn.disabled = true;
  btn.classList.add('loading');
  btn.innerHTML = 'â³ ì¢Œí‘œ ë³€í™˜ ì¤‘...';
  result.style.display = 'none';
  
  try {
    // ë„¤ì´ë²„ Geocoding API ì‚¬ìš© (í™•ì¥í”„ë¡œê·¸ë¨ì²˜ëŸ¼)
    const coords = await getNaverCoordinates(address);
    
    // ë§¤ë¬¼/ê±°ë˜ ìœ í˜• ê°€ì ¸ì˜¤ê¸° (í™•ì¥í”„ë¡œê·¸ë¨ ë¡œì§)
    const propertyTypes = Array.from(document.querySelectorAll('#property-types .toggle-btn[data-checked="true"]'))
      .map(btn => btn.dataset.value);
    const dealType = document.querySelector('#deal-types .toggle-btn.radio[data-checked="true"]')?.dataset.value || 'B2';
    
    // âœ… í™•ì¥í”„ë¡œê·¸ë¨ê³¼ ë™ì¼í•œ ë„¤ì´ë²„ ë¶€ë™ì‚° ë§í¬ ìƒì„±
    const realtorLink = `https://new.land.naver.com/offices?ms=${coords.lat},${coords.lng},19&a=${propertyTypes.join(':')}&b=${dealType}`;
    const mapLink = `https://map.naver.com/p/search/${encodeURIComponent(address)}/address/${coords.lng},${coords.lat},${encodeURIComponent(address)},new?c=18.00,0,0,0,dh&isCorrectAnswer=true`;
    
    // ê²°ê³¼ í‘œì‹œ
    document.getElementById('realtorLink').href = realtorLink;
    document.getElementById('realtorLink').textContent = realtorLink;
    document.getElementById('mapLink').href = mapLink;
    document.getElementById('mapLink').textContent = mapLink;
    
    result.className = '';
    result.style.display = 'block';
    result.scrollIntoView({ behavior: 'smooth' });
    
  } catch (error) {
    console.error('ë³€í™˜ ì˜¤ë¥˜:', error);
    
    // ëŒ€ì²´ ë§í¬ (ì£¼ì†Œ ê²€ìƒ‰)
    const encoded = encodeURIComponent(address);
    const fallbackMap = `https://map.naver.com/p/search/${encoded}`;
    const fallbackRealtor = `https://new.land.naver.com/offices?query=${encoded}`;
    
    document.getElementById('mapLink').href = fallbackMap;
    document.getElementById('mapLink').textContent = fallbackMap;
    document.getElementById('realtorLink').href = fallbackRealtor;
    document.getElementById('realtorLink').textContent = fallbackRealtor;
    
    result.className = 'error';
    result.querySelector('.result-header strong').textContent = 'âš ï¸ ëŒ€ì²´ ë§í¬ ìƒì„±ë¨';
    result.style.display = 'block';
    result.scrollIntoView({ behavior: 'smooth' });
  } finally {
    btn.disabled = false;
    btn.classList.remove('loading');
    btn.innerHTML = 'ğŸ”— ë„¤ì´ë²„ ë§í¬ ìƒì„±';
  }
}

// ë„¤ì´ë²„ Geocoding API (ì¹´ì¹´ì˜¤ì™€ ë™ì¼í•œ í˜•ì‹)
async function getNaverCoordinates(address) {
  const API_KEY = '5aa11b53a04d1bd6f78c87e27a21a400'; // ì œê³µëœ í‚¤ ì‚¬ìš©
  const url = `https://dapi.kakao.com/v2/local/search/address.json?query=${encodeURIComponent(address)}`;
  
  const response = await fetch(url, {
    headers: { 'Authorization': `KakaoAK ${API_KEY}` }
  });
  
  const data = await response.json();
  if (!data.documents?.length) throw new Error('ì£¼ì†Œ ì°¾ê¸° ì‹¤íŒ¨');
  
  const result = data.documents[0];
  return {
    lat: result.y,
    lng: result.x,
    fullAddress: result.address_name || address
  };
}

// í† ê¸€ ë²„íŠ¼ ì´ë²¤íŠ¸ (í™•ì¥í”„ë¡œê·¸ë¨ê³¼ ë™ì¼)
function setupToggleButtons() {
  // ë§¤ë¬¼ ìœ í˜• (ë³µìˆ˜ì„ íƒ)
  document.querySelectorAll('#property-types .toggle-btn').forEach(btn => {
    btn.addEventListener('click', () => {
      const isChecked = btn.dataset.checked === 'true';
      btn.dataset.checked = (!isChecked).toString();
    });
  });
  
  // ê±°ë˜ ìœ í˜• (ë‹¨ì¼ì„ íƒ)
  document.querySelectorAll('#deal-types .toggle-btn.radio').forEach(btn => {
    btn.addEventListener('click', () => {
      document.querySelectorAll('#deal-types .toggle-btn.radio').forEach(b => {
        b.dataset.checked = 'false';
      });
      btn.dataset.checked = 'true';
    });
  });
}

// ë³µì‚¬ ê¸°ëŠ¥
function copyAllLinks() {
  const links = [
    document.getElementById('mapLink').href,
    document.getElementById('realtorLink').href
  ].join('\n');
  
  navigator.clipboard.writeText(links).then(() => {
    const btn = document.getElementById('copyBtn');
    const original = btn.textContent;
    btn.textContent = 'âœ… ë³µì‚¬ì™„ë£Œ!';
    btn.style.background = '#4caf50';
    setTimeout(() => {
      btn.textContent = original;
      btn.style.background = '';
    }, 2000);
  });
}

// ì´ˆê¸°í™”
document.addEventListener('DOMContentLoaded', function() {
  setupToggleButtons();
  
  document.getElementById('convertBtn').addEventListener('click', convertToNaverLinks);
  document.getElementById('address').addEventListener('keypress', function(e) {
    if (e.key === 'Enter') convertToNaverLinks();
  });
  
  document.getElementById('copyBtn').addEventListener('click', copyAllLinks);
  
  // URL íŒŒë¼ë¯¸í„° ìë™ ì‹¤í–‰ (ëª¨ë“  ì˜¤íƒ€ ì§€ì›)
  const params = new URLSearchParams(location.search);
  const addr = params.get('address') || params.get('addres') || params.get('addr');
  if (addr) {
    document.getElementById('address').value = decodeURIComponent(addr);
    setTimeout(convertToNaverLinks, 1000);
  }
});
</script>
</body>
</html>
